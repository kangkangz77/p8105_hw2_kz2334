Homework 2
================
Kangkang Zhang
10/2/2018

Problem 1
---------

Load package tidyverse.

``` r
library(tidyverse)
```

    ## ── Attaching packages ─────────────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ──

    ## ✔ ggplot2 3.0.0     ✔ purrr   0.2.5
    ## ✔ tibble  1.4.2     ✔ dplyr   0.7.6
    ## ✔ tidyr   0.8.1     ✔ stringr 1.3.1
    ## ✔ readr   1.1.1     ✔ forcats 0.3.0

    ## ── Conflicts ────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()

Read NYC Transit data and do data cleaning as question required.

``` r
transit_data = read_csv("./data/NYC_transit.csv") %>% 
  janitor::clean_names() %>%  
  select(line, station_name, station_latitude, station_longitude,
         starts_with("route"), entry, vending, entrance_type, ada) %>% 
   mutate(entry = ifelse(entry == "YES", TRUE, FALSE))
```

    ## Parsed with column specification:
    ## cols(
    ##   .default = col_character(),
    ##   `Station Latitude` = col_double(),
    ##   `Station Longitude` = col_double(),
    ##   Route8 = col_integer(),
    ##   Route9 = col_integer(),
    ##   Route10 = col_integer(),
    ##   Route11 = col_integer(),
    ##   ADA = col_logical(),
    ##   `Free Crossover` = col_logical(),
    ##   `Entrance Latitude` = col_double(),
    ##   `Entrance Longitude` = col_double()
    ## )

    ## See spec(...) for full column specifications.

This dataset is about New York transportation. It contains variables including line, station name / latitude / longitute, routes served, entry, vending, entrance\_type and ADA compliance.

Here is the data cleaning step:

1.  clean up variables'names.
2.  retain variables the question mentioned.
3.  convert the entry variable from character to logical.

The dimension of the dataset is (1868, 19).

The data are not tidy. Because some variables, such like the factor that whether a station served for A line, have values appear in different columns among route1 - route11.

------------------------------------------------------------------------

Use distinct function to find out number of distinct stations.

``` r
distinct(transit_data, line, station_name)
```

    ## # A tibble: 465 x 2
    ##    line     station_name            
    ##    <chr>    <chr>                   
    ##  1 4 Avenue 25th St                 
    ##  2 4 Avenue 36th St                 
    ##  3 4 Avenue 45th St                 
    ##  4 4 Avenue 53rd St                 
    ##  5 4 Avenue 59th St                 
    ##  6 4 Avenue 77th St                 
    ##  7 4 Avenue 86th St                 
    ##  8 4 Avenue 95th St                 
    ##  9 4 Avenue 9th St                  
    ## 10 4 Avenue Atlantic Av-Barclays Ctr
    ## # ... with 455 more rows

There are 465 distinct stations.

------------------------------------------------------------------------

Use filter and distinct to find out number of stations which are ADA compliant.

``` r
transit_data %>% 
  filter(ada == TRUE) %>% 
  distinct(line, station_name, ada)
```

    ## # A tibble: 84 x 3
    ##    line            station_name                   ada  
    ##    <chr>           <chr>                          <lgl>
    ##  1 4 Avenue        Atlantic Av-Barclays Ctr       TRUE 
    ##  2 4 Avenue        DeKalb Av                      TRUE 
    ##  3 4 Avenue        Pacific St                     TRUE 
    ##  4 42nd St Shuttle Grand Central                  TRUE 
    ##  5 6 Avenue        34th St                        TRUE 
    ##  6 6 Avenue        47-50th Sts Rockefeller Center TRUE 
    ##  7 6 Avenue        Church Av                      TRUE 
    ##  8 63rd Street     21st St                        TRUE 
    ##  9 63rd Street     Lexington Av                   TRUE 
    ## 10 63rd Street     Roosevelt Island               TRUE 
    ## # ... with 74 more rows

82 stations are ADA compliant.

------------------------------------------------------------------------

Use filter to find out proportion of station entrances / exits without vending allow entrance.

``` r
entry_data = filter(transit_data, vending == "NO" & entry == TRUE) 
dim(entry_data)[1] / dim(transit_data)[1]
```

    ## [1] 0.0369379

There are 3.69% station entrances / exits without vending allow entrance.

------------------------------------------------------------------------

Reformat the dataset with distinct route name and route number.

``` r
route_data = gather(transit_data, key = route_number, value = route_name, route1:route11) %>% 
  filter(is.na(route_name) == FALSE)
```

------------------------------------------------------------------------

Find out the number of distinct stations serve the A train and the number of ADA compliant of them.

``` r
route_data %>% 
  filter(route_name == "A") %>% 
  distinct(line, station_name, route_name)
```

    ## # A tibble: 60 x 3
    ##    line            station_name                  route_name
    ##    <chr>           <chr>                         <chr>     
    ##  1 42nd St Shuttle Times Square                  A         
    ##  2 8 Avenue        125th St                      A         
    ##  3 8 Avenue        145th St                      A         
    ##  4 8 Avenue        14th St                       A         
    ##  5 8 Avenue        168th St - Washington Heights A         
    ##  6 8 Avenue        175th St                      A         
    ##  7 8 Avenue        181st St                      A         
    ##  8 8 Avenue        190th St                      A         
    ##  9 8 Avenue        34th St                       A         
    ## 10 8 Avenue        42nd St                       A         
    ## # ... with 50 more rows

60 stations serve the A train.

------------------------------------------------------------------------

``` r
route_data %>% 
  filter(route_name == "A") %>% 
  distinct(line, station_name, route_name, ada) %>% 
  filter(ada == TRUE)
```

    ## # A tibble: 17 x 4
    ##    line             station_name                  ada   route_name
    ##    <chr>            <chr>                         <lgl> <chr>     
    ##  1 8 Avenue         14th St                       TRUE  A         
    ##  2 8 Avenue         168th St - Washington Heights TRUE  A         
    ##  3 8 Avenue         175th St                      TRUE  A         
    ##  4 8 Avenue         34th St                       TRUE  A         
    ##  5 8 Avenue         42nd St                       TRUE  A         
    ##  6 8 Avenue         59th St                       TRUE  A         
    ##  7 8 Avenue         Inwood - 207th St             TRUE  A         
    ##  8 8 Avenue         West 4th St                   TRUE  A         
    ##  9 8 Avenue         World Trade Center            TRUE  A         
    ## 10 Broadway         Times Square-42nd St          TRUE  A         
    ## 11 Broadway-7th Ave 59th St-Columbus Circle       TRUE  A         
    ## 12 Broadway-7th Ave Times Square                  TRUE  A         
    ## 13 Canarsie         8th Av                        TRUE  A         
    ## 14 Franklin         Franklin Av                   TRUE  A         
    ## 15 Fulton           Euclid Av                     TRUE  A         
    ## 16 Fulton           Franklin Av                   TRUE  A         
    ## 17 Rockaway         Howard Beach                  TRUE  A

17 stations which serve the A train are ADA compliant.

------------------------------------------------------------------------

Problem 2
---------

Read and clean the Mr. Trash Wheel sheet.

``` r
library(readxl)
trash_data = read_excel(path = "./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", 
                        range = "Mr. Trash Wheel!A2:N388") %>% 
  janitor::clean_names() %>% 
  filter(is.na(dumpster) == FALSE) %>% 
  mutate(weight = weight_tons, volume = volume_cubic_yards, 
          sports_balls = as.integer(round(sports_balls, 0))) %>% 
  select(- weight_tons, - volume_cubic_yards)
trash_data
```

    ## # A tibble: 285 x 14
    ##    dumpster month  year date                plastic_bottles polystyrene
    ##       <dbl> <chr> <dbl> <dttm>                        <dbl>       <dbl>
    ##  1        1 May    2014 2014-05-16 00:00:00            1450        1820
    ##  2        2 May    2014 2014-05-16 00:00:00            1120        1030
    ##  3        3 May    2014 2014-05-16 00:00:00            2450        3100
    ##  4        4 May    2014 2014-05-17 00:00:00            2380        2730
    ##  5        5 May    2014 2014-05-17 00:00:00             980         870
    ##  6        6 May    2014 2014-05-20 00:00:00            1430        2140
    ##  7        7 May    2014 2014-05-21 00:00:00             910        1090
    ##  8        8 May    2014 2014-05-28 00:00:00            3580        4310
    ##  9        9 June   2014 2014-06-05 00:00:00            2400        2790
    ## 10       10 June   2014 2014-06-11 00:00:00            1340        1730
    ## # ... with 275 more rows, and 8 more variables: cigarette_butts <dbl>,
    ## #   glass_bottles <dbl>, grocery_bags <dbl>, chip_bags <dbl>,
    ## #   sports_balls <int>, homes_powered <dbl>, weight <dbl>, volume <dbl>

------------------------------------------------------------------------

Read precipitation data for 2016 and 2017. Add year variable.

``` r
prcp_2016_data = read_excel(path = "./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", 
                            range = "2016 Precipitation!A2:B14") %>% 
  mutate(year = 2016)
prcp_2017_data = read_excel(path = "./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", 
                            range = "2017 Precipitation!A2:B14") %>% 
  mutate(year = 2017)
```

------------------------------------------------------------------------

Combine datasets and convert month to a character variable.

``` r
prcp_data = rbind(prcp_2016_data, prcp_2017_data) %>% 
  janitor::clean_names() %>% 
  mutate(month = month.name[month])
prcp_data
```

    ## # A tibble: 24 x 3
    ##    month     total  year
    ##    <chr>     <dbl> <dbl>
    ##  1 January    3.23  2016
    ##  2 February   5.32  2016
    ##  3 March      2.24  2016
    ##  4 April      1.78  2016
    ##  5 May        5.19  2016
    ##  6 June       3.2   2016
    ##  7 July       6.09  2016
    ##  8 August     3.96  2016
    ##  9 September  4.53  2016
    ## 10 October    0.62  2016
    ## # ... with 14 more rows

**Mr. Trash Wheel dataset**:

-   The number of observations is 285.
-   The mean weight of dumpsters is 3.28 tons.
-   Maximum weight of dumpsters is 5.62 tons.
-   Minimum weight of dumpsters is 0.96 tons.
-   The mean homes powered of dumpsters is 42.

**2016 and 2017 precipitation dataset**:

-   The number of observations is 24.
-   The average monthly precipitation in 2016 and 2017 is 3.04 in.
-   Maximum monthly precipitation in 2016 and 2017 is 7.09 tons.
-   Minimum monthly precipitation in 2016 and 2017 is 0 tons.

The total precipitation in 2017 was 2.74.

The median number of sports balls in a dumpster in 2016 was 26.
